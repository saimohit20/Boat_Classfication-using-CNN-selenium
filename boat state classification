{"cells":[{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"id":"Leh8dowGPyUt","executionInfo":{"status":"ok","timestamp":1732875041287,"user_tz":-60,"elapsed":88089,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"a91422a3-7b14-4047-b471-916e078d5c51","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["!unzip \"/content/drive/MyDrive/Machine Learning with TensorFlow/Ships_Classfication/Boats.zip\""],"metadata":{"id":"z7sOS4chQM3N","executionInfo":{"status":"ok","timestamp":1732875088068,"user_tz":-60,"elapsed":2171,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"8c5aa79b-3093-494e-cc50-243a8d97547d","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Archive:  /content/drive/MyDrive/Machine Learning with TensorFlow/Ships_Classfication/Boats.zip\n","   creating: Boats/\n","   creating: Boats/fire/\n","  inflating: Boats/fire/1 (2).jpg    \n","  inflating: Boats/fire/1 (3).jpg    \n","  inflating: Boats/fire/1.jpg        \n","  inflating: Boats/fire/10 (2).jpg   \n","  inflating: Boats/fire/10 (3).jpg   \n","  inflating: Boats/fire/10.jpg       \n","  inflating: Boats/fire/101.jpg      \n","  inflating: Boats/fire/102.jpg      \n","  inflating: Boats/fire/103.jpg      \n","  inflating: Boats/fire/104.jpg      \n","  inflating: Boats/fire/105.jpg      \n","  inflating: Boats/fire/106.jpg      \n","  inflating: Boats/fire/108.jpg      \n","  inflating: Boats/fire/109.jpg      \n","  inflating: Boats/fire/11 (2).jpg   \n","  inflating: Boats/fire/11 (3).jpg   \n","  inflating: Boats/fire/11.jpg       \n","  inflating: Boats/fire/110.jpg      \n","  inflating: Boats/fire/111.jpg      \n","  inflating: Boats/fire/112.jpg      \n","  inflating: Boats/fire/113.jpg      \n","  inflating: Boats/fire/114.jpg      \n","  inflating: Boats/fire/115.jpg      \n","  inflating: Boats/fire/116.jpg      \n","  inflating: Boats/fire/117.jpg      \n","  inflating: Boats/fire/118.jpg      \n","  inflating: Boats/fire/12 (2).jpg   \n","  inflating: Boats/fire/12 (3).jpg   \n","  inflating: Boats/fire/12.jpg       \n","  inflating: Boats/fire/120.jpg      \n","  inflating: Boats/fire/121.jpg      \n","  inflating: Boats/fire/122.jpg      \n","  inflating: Boats/fire/123.jpg      \n","  inflating: Boats/fire/124.jpg      \n","  inflating: Boats/fire/126.jpg      \n","  inflating: Boats/fire/128.jpg      \n","  inflating: Boats/fire/129.jpg      \n","  inflating: Boats/fire/13 (2).jpg   \n","  inflating: Boats/fire/13 (3).jpg   \n","  inflating: Boats/fire/13.jpg       \n","  inflating: Boats/fire/130.jpg      \n","  inflating: Boats/fire/131.jpg      \n","  inflating: Boats/fire/132.jpg      \n","  inflating: Boats/fire/133.jpg      \n","  inflating: Boats/fire/134.jpg      \n","  inflating: Boats/fire/135.jpg      \n","  inflating: Boats/fire/138.jpg      \n","  inflating: Boats/fire/139.jpg      \n","  inflating: Boats/fire/14 (2).jpg   \n","  inflating: Boats/fire/14 (3).jpg   \n","  inflating: Boats/fire/14.jpg       \n","  inflating: Boats/fire/140.jpg      \n","  inflating: Boats/fire/142.jpg      \n","  inflating: Boats/fire/143.jpg      \n","  inflating: Boats/fire/144.jpg      \n","  inflating: Boats/fire/145.jpg      \n","  inflating: Boats/fire/148.jpg      \n","  inflating: Boats/fire/149.jpg      \n","  inflating: Boats/fire/15 (2).jpg   \n","  inflating: Boats/fire/15 (3).jpg   \n","  inflating: Boats/fire/15.jpg       \n","  inflating: Boats/fire/151.jpg      \n","  inflating: Boats/fire/152.jpg      \n","  inflating: Boats/fire/153.jpg      \n","  inflating: Boats/fire/154.jpg      \n","  inflating: Boats/fire/155.jpg      \n","  inflating: Boats/fire/156.jpg      \n","  inflating: Boats/fire/157.jpg      \n","  inflating: Boats/fire/158.jpg      \n","  inflating: Boats/fire/159.jpg      \n","  inflating: Boats/fire/16 (2).jpg   \n","  inflating: Boats/fire/16 (3).jpg   \n","  inflating: Boats/fire/16.jpg       \n","  inflating: Boats/fire/160.jpg      \n","  inflating: Boats/fire/161.jpg      \n","  inflating: Boats/fire/163.jpg      \n","  inflating: Boats/fire/164.jpg      \n","  inflating: Boats/fire/165.jpg      \n","  inflating: Boats/fire/166.jpg      \n","  inflating: Boats/fire/168.jpg      \n","  inflating: Boats/fire/169.jpg      \n","  inflating: Boats/fire/17 (2).jpg   \n","  inflating: Boats/fire/17 (3).jpg   \n","  inflating: Boats/fire/17.jpg       \n","  inflating: Boats/fire/18 (2).jpg   \n","  inflating: Boats/fire/18 (3).jpg   \n","  inflating: Boats/fire/18.jpg       \n","  inflating: Boats/fire/19 (2).jpg   \n","  inflating: Boats/fire/19 (3).jpg   \n","  inflating: Boats/fire/19.jpg       \n","  inflating: Boats/fire/2 (2).jpg    \n","  inflating: Boats/fire/2 (3).jpg    \n","  inflating: Boats/fire/2.jpg        \n","  inflating: Boats/fire/20 (2).jpg   \n","  inflating: Boats/fire/20 (3).jpg   \n","  inflating: Boats/fire/20.jpg       \n","  inflating: Boats/fire/21 (2).jpg   \n","  inflating: Boats/fire/21 (3).jpg   \n","  inflating: Boats/fire/21.jpg       \n","  inflating: Boats/fire/22 (2).jpg   \n","  inflating: Boats/fire/22 (3).jpg   \n","  inflating: Boats/fire/22.jpg       \n","  inflating: Boats/fire/23 (2).jpg   \n","  inflating: Boats/fire/23 (3).jpg   \n","  inflating: Boats/fire/23.jpg       \n","  inflating: Boats/fire/24 (2).jpg   \n","  inflating: Boats/fire/24 (3).jpg   \n","  inflating: Boats/fire/24.jpg       \n","  inflating: Boats/fire/26 (2).jpg   \n","  inflating: Boats/fire/26 (3).jpg   \n","  inflating: Boats/fire/26.jpg       \n","  inflating: Boats/fire/27 (2).jpg   \n","  inflating: Boats/fire/27 (3).jpg   \n","  inflating: Boats/fire/27.jpg       \n","  inflating: Boats/fire/28 (2).jpg   \n","  inflating: Boats/fire/28 (3).jpg   \n","  inflating: Boats/fire/28.jpg       \n","  inflating: Boats/fire/29 (2).jpg   \n","  inflating: Boats/fire/29 (3).jpg   \n","  inflating: Boats/fire/29.jpg       \n","  inflating: Boats/fire/3 (2).jpg    \n","  inflating: Boats/fire/3 (3).jpg    \n","  inflating: Boats/fire/3.jpg        \n","  inflating: Boats/fire/30 (2).jpg   \n","  inflating: Boats/fire/30 (3).jpg   \n","  inflating: Boats/fire/30.jpg       \n","  inflating: Boats/fire/31 (2).jpg   \n","  inflating: Boats/fire/31 (3).jpg   \n","  inflating: Boats/fire/31.jpg       \n","  inflating: Boats/fire/32 (2).jpg   \n","  inflating: Boats/fire/32 (3).jpg   \n","  inflating: Boats/fire/32.jpg       \n","  inflating: Boats/fire/33 (2).jpg   \n","  inflating: Boats/fire/33 (3).jpg   \n","  inflating: Boats/fire/33.jpg       \n","  inflating: Boats/fire/34 (2).jpg   \n","  inflating: Boats/fire/34 (3).jpg   \n","  inflating: Boats/fire/34.jpg       \n","  inflating: Boats/fire/35 (2).jpg   \n","  inflating: Boats/fire/35 (3).jpg   \n","  inflating: Boats/fire/35.jpg       \n","  inflating: Boats/fire/36 (2).jpg   \n","  inflating: Boats/fire/36 (3).jpg   \n","  inflating: Boats/fire/36.jpg       \n","  inflating: Boats/fire/37 (2).jpg   \n","  inflating: Boats/fire/37 (3).jpg   \n","  inflating: Boats/fire/37.jpg       \n","  inflating: Boats/fire/38 (2).jpg   \n","  inflating: Boats/fire/38 (3).jpg   \n","  inflating: Boats/fire/38.jpg       \n","  inflating: Boats/fire/39 (2).jpg   \n","  inflating: Boats/fire/39.jpg       \n","  inflating: Boats/fire/4 (2).jpg    \n","  inflating: Boats/fire/4 (3).jpg    \n","  inflating: Boats/fire/4.jpg        \n","  inflating: Boats/fire/40 (2).jpg   \n","  inflating: Boats/fire/40 (3).jpg   \n","  inflating: Boats/fire/40.jpg       \n","  inflating: Boats/fire/41 (2).jpg   \n","  inflating: Boats/fire/41 (3).jpg   \n","  inflating: Boats/fire/41.jpg       \n","  inflating: Boats/fire/42 (2).jpg   \n","  inflating: Boats/fire/42 (3).jpg   \n","  inflating: Boats/fire/42.jpg       \n","  inflating: Boats/fire/43 (2).jpg   \n","  inflating: Boats/fire/43.jpg       \n","  inflating: Boats/fire/44 (2).jpg   \n","  inflating: Boats/fire/44 (3).jpg   \n","  inflating: Boats/fire/44.jpg       \n","  inflating: Boats/fire/45 (2).jpg   \n","  inflating: Boats/fire/45 (3).jpg   \n","  inflating: Boats/fire/45.jpg       \n","  inflating: Boats/fire/46 (2).jpg   \n","  inflating: Boats/fire/46 (3).jpg   \n","  inflating: Boats/fire/46.jpg       \n","  inflating: Boats/fire/47 (2).jpg   \n","  inflating: Boats/fire/47 (3).jpg   \n","  inflating: Boats/fire/47.jpg       \n","  inflating: Boats/fire/48 (2).jpg   \n","  inflating: Boats/fire/48 (3).jpg   \n","  inflating: Boats/fire/48.jpg       \n","  inflating: Boats/fire/49 (2).jpg   \n","  inflating: Boats/fire/49 (3).jpg   \n","  inflating: Boats/fire/49.jpg       \n","  inflating: Boats/fire/5 (2).jpg    \n","  inflating: Boats/fire/5 (3).jpg    \n","  inflating: Boats/fire/5.jpg        \n","  inflating: Boats/fire/51 (2).jpg   \n","  inflating: Boats/fire/51 (3).jpg   \n","  inflating: Boats/fire/51.jpg       \n","  inflating: Boats/fire/52 (2).jpg   \n","  inflating: Boats/fire/52 (3).jpg   \n","  inflating: Boats/fire/52.jpg       \n","  inflating: Boats/fire/53 (2).jpg   \n","  inflating: Boats/fire/53.jpg       \n","  inflating: Boats/fire/54 (2).jpg   \n","  inflating: Boats/fire/54 (3).jpg   \n","  inflating: Boats/fire/54.jpg       \n","  inflating: Boats/fire/55 (2).jpg   \n","  inflating: Boats/fire/55 (3).jpg   \n","  inflating: Boats/fire/55.jpg       \n","  inflating: Boats/fire/56 (2).jpg   \n","  inflating: Boats/fire/56 (3).jpg   \n","  inflating: Boats/fire/56.jpg       \n","  inflating: Boats/fire/57 (2).jpg   \n","  inflating: Boats/fire/57 (3).jpg   \n","  inflating: Boats/fire/57.jpg       \n","  inflating: Boats/fire/58 (2).jpg   \n","  inflating: Boats/fire/58 (3).jpg   \n","  inflating: Boats/fire/58.jpg       \n","  inflating: Boats/fire/59 (2).jpg   \n","  inflating: Boats/fire/59 (3).jpg   \n","  inflating: Boats/fire/59.jpg       \n","  inflating: Boats/fire/6 (2).jpg    \n","  inflating: Boats/fire/6 (3).jpg    \n","  inflating: Boats/fire/6.jpg        \n","  inflating: Boats/fire/60 (2).jpg   \n","  inflating: Boats/fire/60 (3).jpg   \n","  inflating: Boats/fire/60.jpg       \n","  inflating: Boats/fire/61 (2).jpg   \n","  inflating: Boats/fire/61 (3).jpg   \n","  inflating: Boats/fire/61.jpg       \n","  inflating: Boats/fire/62 (2).jpg   \n","  inflating: Boats/fire/62 (3).jpg   \n","  inflating: Boats/fire/62.jpg       \n","  inflating: Boats/fire/63 (2).jpg   \n","  inflating: Boats/fire/63 (3).jpg   \n","  inflating: Boats/fire/63.jpg       \n","  inflating: Boats/fire/64 (2).jpg   \n","  inflating: Boats/fire/64 (3).jpg   \n","  inflating: Boats/fire/64.jpg       \n","  inflating: Boats/fire/65 (2).jpg   \n","  inflating: Boats/fire/65 (3).jpg   \n","  inflating: Boats/fire/65.jpg       \n","  inflating: Boats/fire/66 (2).jpg   \n","  inflating: Boats/fire/66 (3).jpg   \n","  inflating: Boats/fire/66.jpg       \n","  inflating: Boats/fire/67 (2).jpg   \n","  inflating: Boats/fire/67 (3).jpg   \n","  inflating: Boats/fire/67.jpg       \n","  inflating: Boats/fire/68 (2).jpg   \n","  inflating: Boats/fire/68 (3).jpg   \n","  inflating: Boats/fire/68.jpg       \n","  inflating: Boats/fire/69 (2).jpg   \n","  inflating: Boats/fire/69 (3).jpg   \n","  inflating: Boats/fire/69.jpg       \n","  inflating: Boats/fire/7 (2).jpg    \n","  inflating: Boats/fire/7 (3).jpg    \n","  inflating: Boats/fire/7.jpg        \n","  inflating: Boats/fire/70 (2).jpg   \n","  inflating: Boats/fire/70 (3).jpg   \n","  inflating: Boats/fire/70.jpg       \n","  inflating: Boats/fire/71 (2).jpg   \n","  inflating: Boats/fire/71 (3).jpg   \n","  inflating: Boats/fire/71.jpg       \n","  inflating: Boats/fire/72 (2).jpg   \n","  inflating: Boats/fire/72 (3).jpg   \n","  inflating: Boats/fire/72.jpg       \n","  inflating: Boats/fire/73 (2).jpg   \n","  inflating: Boats/fire/73.jpg       \n","  inflating: Boats/fire/74 (2).jpg   \n","  inflating: Boats/fire/74 (3).jpg   \n","  inflating: Boats/fire/74.jpg       \n","  inflating: Boats/fire/76 (2).jpg   \n","  inflating: Boats/fire/76 (3).jpg   \n","  inflating: Boats/fire/76.jpg       \n","  inflating: Boats/fire/77 (2).jpg   \n","  inflating: Boats/fire/77 (3).jpg   \n","  inflating: Boats/fire/77.jpg       \n","  inflating: Boats/fire/78 (2).jpg   \n","  inflating: Boats/fire/78 (3).jpg   \n","  inflating: Boats/fire/78.jpg       \n","  inflating: Boats/fire/79 (2).jpg   \n","  inflating: Boats/fire/79 (3).jpg   \n","  inflating: Boats/fire/79.jpg       \n","  inflating: Boats/fire/8 (2).jpg    \n","  inflating: Boats/fire/8 (3).jpg    \n","  inflating: Boats/fire/8.jpg        \n","  inflating: Boats/fire/80 (2).jpg   \n","  inflating: Boats/fire/80 (3).jpg   \n","  inflating: Boats/fire/80.jpg       \n","  inflating: Boats/fire/81 (2).jpg   \n","  inflating: Boats/fire/81.jpg       \n","  inflating: Boats/fire/82 (2).jpg   \n","  inflating: Boats/fire/82 (3).jpg   \n","  inflating: Boats/fire/82.jpg       \n","  inflating: Boats/fire/83 (2).jpg   \n","  inflating: Boats/fire/83 (3).jpg   \n","  inflating: Boats/fire/83.jpg       \n","  inflating: Boats/fire/84 (2).jpg   \n","  inflating: Boats/fire/84 (3).jpg   \n","  inflating: Boats/fire/84.jpg       \n","  inflating: Boats/fire/85 (2).jpg   \n","  inflating: Boats/fire/85 (3).jpg   \n","  inflating: Boats/fire/85.jpg       \n","  inflating: Boats/fire/86 (2).jpg   \n","  inflating: Boats/fire/86 (3).jpg   \n","  inflating: Boats/fire/86.jpg       \n","  inflating: Boats/fire/87 (2).jpg   \n","  inflating: Boats/fire/87 (3).jpg   \n","  inflating: Boats/fire/87.jpg       \n","  inflating: Boats/fire/88 (2).jpg   \n","  inflating: Boats/fire/88 (3).jpg   \n","  inflating: Boats/fire/88.jpg       \n","  inflating: Boats/fire/89 (2).jpg   \n","  inflating: Boats/fire/89 (3).jpg   \n","  inflating: Boats/fire/89.jpg       \n","  inflating: Boats/fire/9 (2).jpg    \n","  inflating: Boats/fire/9 (3).jpg    \n","  inflating: Boats/fire/9.jpg        \n","  inflating: Boats/fire/90 (2).jpg   \n","  inflating: Boats/fire/90 (3).jpg   \n","  inflating: Boats/fire/90.jpg       \n","  inflating: Boats/fire/91 (2).jpg   \n","  inflating: Boats/fire/91 (3).jpg   \n","  inflating: Boats/fire/91.jpg       \n","  inflating: Boats/fire/92 (2).jpg   \n","  inflating: Boats/fire/92 (3).jpg   \n","  inflating: Boats/fire/92.jpg       \n","  inflating: Boats/fire/93 (2).jpg   \n","  inflating: Boats/fire/93 (3).jpg   \n","  inflating: Boats/fire/93.jpg       \n","  inflating: Boats/fire/94 (2).jpg   \n","  inflating: Boats/fire/94 (3).jpg   \n","  inflating: Boats/fire/94.jpg       \n","  inflating: Boats/fire/95 (2).jpg   \n","  inflating: Boats/fire/95 (3).jpg   \n","  inflating: Boats/fire/95.jpg       \n","  inflating: Boats/fire/96 (2).jpg   \n","  inflating: Boats/fire/96 (3).jpg   \n","  inflating: Boats/fire/96.jpg       \n","  inflating: Boats/fire/97 (2).jpg   \n","  inflating: Boats/fire/97.jpg       \n","  inflating: Boats/fire/98 (2).jpg   \n","  inflating: Boats/fire/98 (3).jpg   \n","  inflating: Boats/fire/98.jpg       \n","  inflating: Boats/fire/99 (2).jpg   \n","  inflating: Boats/fire/99 (3).jpg   \n","  inflating: Boats/fire/99.jpg       \n","  inflating: Boats/fire/tanker_1.jpg  \n","  inflating: Boats/fire/tanker_10.jpg  \n","  inflating: Boats/fire/tanker_11.jpg  \n","  inflating: Boats/fire/tanker_12.jpg  \n","  inflating: Boats/fire/tanker_13.jpg  \n","  inflating: Boats/fire/tanker_14.jpg  \n","  inflating: Boats/fire/tanker_15.jpg  \n","  inflating: Boats/fire/tanker_16.jpg  \n","  inflating: Boats/fire/tanker_17.jpg  \n","  inflating: Boats/fire/tanker_18.jpg  \n","  inflating: Boats/fire/tanker_19.jpg  \n","  inflating: Boats/fire/tanker_2.jpg  \n","  inflating: Boats/fire/tanker_20.jpg  \n","  inflating: Boats/fire/tanker_21.jpg  \n","  inflating: Boats/fire/tanker_22.jpg  \n","  inflating: Boats/fire/tanker_23.jpg  \n","  inflating: Boats/fire/tanker_24.jpg  \n","  inflating: Boats/fire/tanker_26.jpg  \n","  inflating: Boats/fire/tanker_27.jpg  \n","  inflating: Boats/fire/tanker_29.jpg  \n","  inflating: Boats/fire/tanker_3.jpg  \n","  inflating: Boats/fire/tanker_30.jpg  \n","  inflating: Boats/fire/tanker_31.jpg  \n","  inflating: Boats/fire/tanker_32.jpg  \n","  inflating: Boats/fire/tanker_33.jpg  \n","  inflating: Boats/fire/tanker_34.jpg  \n","  inflating: Boats/fire/tanker_35.jpg  \n","  inflating: Boats/fire/tanker_36.jpg  \n","  inflating: Boats/fire/tanker_37.jpg  \n","  inflating: Boats/fire/tanker_38.jpg  \n","  inflating: Boats/fire/tanker_39.jpg  \n","  inflating: Boats/fire/tanker_4.jpg  \n","  inflating: Boats/fire/tanker_40.jpg  \n","  inflating: Boats/fire/tanker_41.jpg  \n","  inflating: Boats/fire/tanker_42.jpg  \n","  inflating: Boats/fire/tanker_43.jpg  \n","  inflating: Boats/fire/tanker_44.jpg  \n","  inflating: Boats/fire/tanker_45.jpg  \n","  inflating: Boats/fire/tanker_47.jpg  \n","  inflating: Boats/fire/tanker_48.jpg  \n","  inflating: Boats/fire/tanker_49.jpg  \n","  inflating: Boats/fire/tanker_5.jpg  \n","  inflating: Boats/fire/tanker_51.jpg  \n","  inflating: Boats/fire/tanker_52.jpg  \n","  inflating: Boats/fire/tanker_53.jpg  \n","  inflating: Boats/fire/tanker_54.jpg  \n","  inflating: Boats/fire/tanker_55.jpg  \n","  inflating: Boats/fire/tanker_56.jpg  \n","  inflating: Boats/fire/tanker_57.jpg  \n","  inflating: Boats/fire/tanker_58.jpg  \n","  inflating: Boats/fire/tanker_59.jpg  \n","  inflating: Boats/fire/tanker_6.jpg  \n","  inflating: Boats/fire/tanker_60.jpg  \n","  inflating: Boats/fire/tanker_61.jpg  \n","  inflating: Boats/fire/tanker_62.jpg  \n","  inflating: Boats/fire/tanker_63.jpg  \n","  inflating: Boats/fire/tanker_64.jpg  \n","  inflating: Boats/fire/tanker_65.jpg  \n","  inflating: Boats/fire/tanker_66.jpg  \n","  inflating: Boats/fire/tanker_67.jpg  \n","  inflating: Boats/fire/tanker_68.jpg  \n","  inflating: Boats/fire/tanker_69.jpg  \n","  inflating: Boats/fire/tanker_7.jpg  \n","  inflating: Boats/fire/tanker_70.jpg  \n","  inflating: Boats/fire/tanker_71.jpg  \n","  inflating: Boats/fire/tanker_72.jpg  \n","  inflating: Boats/fire/tanker_73.jpg  \n","  inflating: Boats/fire/tanker_74.jpg  \n","  inflating: Boats/fire/tanker_76.jpg  \n","  inflating: Boats/fire/tanker_77.jpg  \n","  inflating: Boats/fire/tanker_78.jpg  \n","  inflating: Boats/fire/tanker_79.jpg  \n","  inflating: Boats/fire/tanker_8.jpg  \n","  inflating: Boats/fire/tanker_80.jpg  \n","  inflating: Boats/fire/tanker_81.jpg  \n","  inflating: Boats/fire/tanker_82.jpg  \n","  inflating: Boats/fire/tanker_83.jpg  \n","  inflating: Boats/fire/tanker_84.jpg  \n","  inflating: Boats/fire/tanker_85.jpg  \n","  inflating: Boats/fire/tanker_86.jpg  \n","  inflating: Boats/fire/tanker_87.jpg  \n","  inflating: Boats/fire/tanker_89.jpg  \n","  inflating: Boats/fire/tanker_9.jpg  \n","  inflating: Boats/fire/tanker_90.jpg  \n","  inflating: Boats/fire/tanker_92.jpg  \n","  inflating: Boats/fire/tanker_93.jpg  \n","  inflating: Boats/fire/tanker_94.jpg  \n","  inflating: Boats/fire/tanker_95.jpg  \n","  inflating: Boats/fire/tanker_96.jpg  \n","  inflating: Boats/fire/tanker_97.jpg  \n","  inflating: Boats/fire/tanker_98.jpg  \n","  inflating: Boats/fire/tanker_99.jpg  \n","   creating: Boats/sinking/\n","  inflating: Boats/sinking/1 (2).jpg  \n","  inflating: Boats/sinking/1.jpg     \n","  inflating: Boats/sinking/10.jpg    \n","  inflating: Boats/sinking/11.jpg    \n","  inflating: Boats/sinking/12.jpg    \n","  inflating: Boats/sinking/13.jpg    \n","  inflating: Boats/sinking/14.jpg    \n","  inflating: Boats/sinking/15.jpg    \n","  inflating: Boats/sinking/16.jpg    \n","  inflating: Boats/sinking/17.jpg    \n","  inflating: Boats/sinking/18.jpg    \n","  inflating: Boats/sinking/19.jpg    \n","  inflating: Boats/sinking/2 (2).jpg  \n","  inflating: Boats/sinking/2.jpg     \n","  inflating: Boats/sinking/20.jpg    \n","  inflating: Boats/sinking/21.jpg    \n","  inflating: Boats/sinking/22.jpg    \n","  inflating: Boats/sinking/23.jpg    \n","  inflating: Boats/sinking/24.jpg    \n","  inflating: Boats/sinking/25.jpg    \n","  inflating: Boats/sinking/26.jpg    \n","  inflating: Boats/sinking/27.jpg    \n","  inflating: Boats/sinking/28.jpg    \n","  inflating: Boats/sinking/29.jpg    \n","  inflating: Boats/sinking/3.jpg     \n","  inflating: Boats/sinking/3.png     \n","  inflating: Boats/sinking/30.jpg    \n","  inflating: Boats/sinking/31.jpg    \n","  inflating: Boats/sinking/4.jpg     \n","  inflating: Boats/sinking/5.jpg     \n","  inflating: Boats/sinking/6.jpg     \n","  inflating: Boats/sinking/7.jpg     \n","  inflating: Boats/sinking/8.jpg     \n","  inflating: Boats/sinking/9.jpg     \n","  inflating: Boats/sinking/sinking-ship-diving-tourism-sinking-ship-diving-tourism-karaburun-izmir-turkey-mediterranian-140455992.webp  \n","  inflating: Boats/sinking/sinking_boats1.jpg  \n","  inflating: Boats/sinking/sinking_boats10.jpg  \n","  inflating: Boats/sinking/sinking_boats11.jpg  \n","  inflating: Boats/sinking/sinking_boats12.jpg  \n","  inflating: Boats/sinking/sinking_boats13.jpg  \n","  inflating: Boats/sinking/sinking_boats14.jpg  \n","  inflating: Boats/sinking/sinking_boats15.jpg  \n","  inflating: Boats/sinking/sinking_boats16.jpg  \n","  inflating: Boats/sinking/sinking_boats17.jpg  \n","  inflating: Boats/sinking/sinking_boats18.jpg  \n","  inflating: Boats/sinking/sinking_boats19.jpg  \n","  inflating: Boats/sinking/sinking_boats2.jpg  \n","  inflating: Boats/sinking/sinking_boats20.jpg  \n","  inflating: Boats/sinking/sinking_boats21.jpg  \n","  inflating: Boats/sinking/sinking_boats22.jpg  \n","  inflating: Boats/sinking/sinking_boats23.jpg  \n","  inflating: Boats/sinking/sinking_boats24.jpg  \n","  inflating: Boats/sinking/sinking_boats26.jpg  \n","  inflating: Boats/sinking/sinking_boats27.jpg  \n","  inflating: Boats/sinking/sinking_boats28.jpg  \n","  inflating: Boats/sinking/sinking_boats29.jpg  \n","  inflating: Boats/sinking/sinking_boats3.jpg  \n","  inflating: Boats/sinking/sinking_boats30.jpg  \n","  inflating: Boats/sinking/sinking_boats31.jpg  \n","  inflating: Boats/sinking/sinking_boats32.jpg  \n","  inflating: Boats/sinking/sinking_boats33.jpg  \n","  inflating: Boats/sinking/sinking_boats34.jpg  \n","  inflating: Boats/sinking/sinking_boats35.jpg  \n","  inflating: Boats/sinking/sinking_boats36.jpg  \n","  inflating: Boats/sinking/sinking_boats37.jpg  \n","  inflating: Boats/sinking/sinking_boats38.jpg  \n","  inflating: Boats/sinking/sinking_boats39.jpg  \n","  inflating: Boats/sinking/sinking_boats4.jpg  \n","  inflating: Boats/sinking/sinking_boats40.jpg  \n","  inflating: Boats/sinking/sinking_boats41.jpg  \n","  inflating: Boats/sinking/sinking_boats42.jpg  \n","  inflating: Boats/sinking/sinking_boats43.jpg  \n","  inflating: Boats/sinking/sinking_boats44.jpg  \n","  inflating: Boats/sinking/sinking_boats45.jpg  \n","  inflating: Boats/sinking/sinking_boats46.jpg  \n","  inflating: Boats/sinking/sinking_boats48.jpg  \n","  inflating: Boats/sinking/sinking_boats49.jpg  \n","  inflating: Boats/sinking/sinking_boats5.jpg  \n","  inflating: Boats/sinking/sinking_boats51.jpg  \n","  inflating: Boats/sinking/sinking_boats53.jpg  \n","  inflating: Boats/sinking/sinking_boats54.jpg  \n","  inflating: Boats/sinking/sinking_boats55.jpg  \n","  inflating: Boats/sinking/sinking_boats56.jpg  \n","  inflating: Boats/sinking/sinking_boats57.jpg  \n","  inflating: Boats/sinking/sinking_boats58.jpg  \n","  inflating: Boats/sinking/sinking_boats59.jpg  \n","  inflating: Boats/sinking/sinking_boats6.jpg  \n","  inflating: Boats/sinking/sinking_boats60.jpg  \n","  inflating: Boats/sinking/sinking_boats62.jpg  \n","  inflating: Boats/sinking/sinking_boats63.jpg  \n","  inflating: Boats/sinking/sinking_boats64.jpg  \n","  inflating: Boats/sinking/sinking_boats65.jpg  \n","  inflating: Boats/sinking/sinking_boats66.jpg  \n","  inflating: Boats/sinking/sinking_boats68.jpg  \n","  inflating: Boats/sinking/sinking_boats69.jpg  \n","  inflating: Boats/sinking/sinking_boats7.jpg  \n","  inflating: Boats/sinking/sinking_boats70.jpg  \n","  inflating: Boats/sinking/sinking_boats71.jpg  \n","  inflating: Boats/sinking/sinking_boats72.jpg  \n","  inflating: Boats/sinking/sinking_boats73.jpg  \n","  inflating: Boats/sinking/sinking_boats74.jpg  \n","  inflating: Boats/sinking/sinking_boats76.jpg  \n","  inflating: Boats/sinking/sinking_boats77.jpg  \n","  inflating: Boats/sinking/sinking_boats78.jpg  \n","  inflating: Boats/sinking/sinking_boats79.jpg  \n","  inflating: Boats/sinking/sinking_boats8.jpg  \n","  inflating: Boats/sinking/sinking_boats80.jpg  \n","  inflating: Boats/sinking/sinking_boats81.jpg  \n","  inflating: Boats/sinking/sinking_boats82.jpg  \n","  inflating: Boats/sinking/sinking_boats83.jpg  \n","  inflating: Boats/sinking/sinking_boats84.jpg  \n","  inflating: Boats/sinking/sinking_boats86.jpg  \n","  inflating: Boats/sinking/sinking_boats87.jpg  \n","  inflating: Boats/sinking/sinking_boats88.jpg  \n","  inflating: Boats/sinking/sinking_boats89.jpg  \n","  inflating: Boats/sinking/sinking_boats9.jpg  \n","  inflating: Boats/sinking/sinking_boats90.jpg  \n","  inflating: Boats/sinking/sinking_boats91.jpg  \n","  inflating: Boats/sinking/sinking_boats92.jpg  \n","  inflating: Boats/sinking/sinking_boats93.jpg  \n","  inflating: Boats/sinking/sinking_boats94.jpg  \n","  inflating: Boats/sinking/sinking_boats95.jpg  \n","  inflating: Boats/sinking/sinking_boats96.jpg  \n","  inflating: Boats/sinking/sinking_boats97.jpg  \n","  inflating: Boats/sinking/sinking_boats98.jpg  \n","  inflating: Boats/sinking/sinking_boats99.jpg  \n","  inflating: Boats/sinking/sink_cap1.jpg  \n","  inflating: Boats/sinking/sink_cap10.jpg  \n","  inflating: Boats/sinking/sink_cap11.jpg  \n","  inflating: Boats/sinking/sink_cap12.jpg  \n","  inflating: Boats/sinking/sink_cap14.jpg  \n","  inflating: Boats/sinking/sink_cap15.jpg  \n","  inflating: Boats/sinking/sink_cap16.jpg  \n","  inflating: Boats/sinking/sink_cap2.jpg  \n","  inflating: Boats/sinking/sink_cap22.jpg  \n","  inflating: Boats/sinking/sink_cap26.jpg  \n","  inflating: Boats/sinking/sink_cap27.jpg  \n","  inflating: Boats/sinking/sink_cap3.jpg  \n","  inflating: Boats/sinking/sink_cap30.jpg  \n","  inflating: Boats/sinking/sink_cap32.jpg  \n","  inflating: Boats/sinking/sink_cap34.jpg  \n","  inflating: Boats/sinking/sink_cap36.jpg  \n","  inflating: Boats/sinking/sink_cap37.jpg  \n","  inflating: Boats/sinking/sink_cap39.jpg  \n","  inflating: Boats/sinking/sink_cap4.jpg  \n","  inflating: Boats/sinking/sink_cap45.jpg  \n","  inflating: Boats/sinking/sink_cap46.jpg  \n","  inflating: Boats/sinking/sink_cap48.jpg  \n","  inflating: Boats/sinking/sink_cap49.jpg  \n","  inflating: Boats/sinking/sink_cap5.jpg  \n","  inflating: Boats/sinking/sink_cap51.jpg  \n","  inflating: Boats/sinking/sink_cap53.jpg  \n","  inflating: Boats/sinking/sink_cap54.jpg  \n","  inflating: Boats/sinking/sink_cap55.jpg  \n","  inflating: Boats/sinking/sink_cap57.jpg  \n","  inflating: Boats/sinking/sink_cap59.jpg  \n","  inflating: Boats/sinking/sink_cap6.jpg  \n","  inflating: Boats/sinking/sink_cap60.jpg  \n","  inflating: Boats/sinking/sink_cap61.jpg  \n","  inflating: Boats/sinking/sink_cap62.jpg  \n","  inflating: Boats/sinking/sink_cap63.jpg  \n","  inflating: Boats/sinking/sink_cap64.jpg  \n","  inflating: Boats/sinking/sink_cap66.jpg  \n","  inflating: Boats/sinking/sink_cap68.jpg  \n","  inflating: Boats/sinking/sink_cap69.jpg  \n","  inflating: Boats/sinking/sink_cap7.jpg  \n","  inflating: Boats/sinking/sink_cap72.jpg  \n","  inflating: Boats/sinking/sink_cap73.jpg  \n","  inflating: Boats/sinking/sink_cap78.jpg  \n","  inflating: Boats/sinking/sink_cap8.jpg  \n","  inflating: Boats/sinking/sink_cap80.jpg  \n","  inflating: Boats/sinking/sink_cap83.jpg  \n","  inflating: Boats/sinking/sink_cap84.jpg  \n","  inflating: Boats/sinking/sink_cap85.jpg  \n","  inflating: Boats/sinking/sink_cap87.jpg  \n","  inflating: Boats/sinking/sink_cap88.jpg  \n","  inflating: Boats/sinking/sink_cap9.jpg  \n","  inflating: Boats/sinking/sink_cap91.jpg  \n","  inflating: Boats/sinking/sink_cap92.jpg  \n","  inflating: Boats/sinking/sink_cap93.jpg  \n","  inflating: Boats/sinking/sink_cap97.jpg  \n","  inflating: Boats/sinking/tanker_1.jpg  \n","  inflating: Boats/sinking/tanker_10.jpg  \n","  inflating: Boats/sinking/tanker_11.jpg  \n","  inflating: Boats/sinking/tanker_12.jpg  \n","  inflating: Boats/sinking/tanker_13.jpg  \n","  inflating: Boats/sinking/tanker_14.jpg  \n","  inflating: Boats/sinking/tanker_15.jpg  \n","  inflating: Boats/sinking/tanker_16.jpg  \n","  inflating: Boats/sinking/tanker_17.jpg  \n","  inflating: Boats/sinking/tanker_18.jpg  \n","  inflating: Boats/sinking/tanker_19.jpg  \n","  inflating: Boats/sinking/tanker_2.jpg  \n","  inflating: Boats/sinking/tanker_20.jpg  \n","  inflating: Boats/sinking/tanker_21.jpg  \n","  inflating: Boats/sinking/tanker_22.jpg  \n","  inflating: Boats/sinking/tanker_23.jpg  \n","  inflating: Boats/sinking/tanker_24.jpg  \n","  inflating: Boats/sinking/tanker_26.jpg  \n","  inflating: Boats/sinking/tanker_27.jpg  \n","  inflating: Boats/sinking/tanker_28.jpg  \n","  inflating: Boats/sinking/tanker_29.jpg  \n","  inflating: Boats/sinking/tanker_3.jpg  \n","  inflating: Boats/sinking/tanker_30.jpg  \n","  inflating: Boats/sinking/tanker_31.jpg  \n","  inflating: Boats/sinking/tanker_32.jpg  \n","  inflating: Boats/sinking/tanker_33.jpg  \n","  inflating: Boats/sinking/tanker_34.jpg  \n","  inflating: Boats/sinking/tanker_35.jpg  \n","  inflating: Boats/sinking/tanker_36.jpg  \n","  inflating: Boats/sinking/tanker_37.jpg  \n","  inflating: Boats/sinking/tanker_38.jpg  \n","  inflating: Boats/sinking/tanker_39.jpg  \n","  inflating: Boats/sinking/tanker_4.jpg  \n","  inflating: Boats/sinking/tanker_40.jpg  \n","  inflating: Boats/sinking/tanker_41.jpg  \n","  inflating: Boats/sinking/tanker_42.jpg  \n","  inflating: Boats/sinking/tanker_43.jpg  \n","  inflating: Boats/sinking/tanker_44.jpg  \n","  inflating: Boats/sinking/tanker_45.jpg  \n","  inflating: Boats/sinking/tanker_46.jpg  \n","  inflating: Boats/sinking/tanker_47.jpg  \n","  inflating: Boats/sinking/tanker_48.jpg  \n","  inflating: Boats/sinking/tanker_49.jpg  \n","  inflating: Boats/sinking/tanker_5.jpg  \n","  inflating: Boats/sinking/tanker_51.jpg  \n","  inflating: Boats/sinking/tanker_52.jpg  \n","  inflating: Boats/sinking/tanker_53.jpg  \n","  inflating: Boats/sinking/tanker_54.jpg  \n","  inflating: Boats/sinking/tanker_55.jpg  \n","  inflating: Boats/sinking/tanker_56.jpg  \n","  inflating: Boats/sinking/tanker_57.jpg  \n","  inflating: Boats/sinking/tanker_59.jpg  \n","  inflating: Boats/sinking/tanker_6.jpg  \n","  inflating: Boats/sinking/tanker_60.jpg  \n","  inflating: Boats/sinking/tanker_61.jpg  \n","  inflating: Boats/sinking/tanker_62.jpg  \n","  inflating: Boats/sinking/tanker_63.jpg  \n","  inflating: Boats/sinking/tanker_64.jpg  \n","  inflating: Boats/sinking/tanker_65.jpg  \n","  inflating: Boats/sinking/tanker_66.jpg  \n","  inflating: Boats/sinking/tanker_67.jpg  \n","  inflating: Boats/sinking/tanker_68.jpg  \n","  inflating: Boats/sinking/tanker_69.jpg  \n","  inflating: Boats/sinking/tanker_7.jpg  \n","  inflating: Boats/sinking/tanker_70.jpg  \n","  inflating: Boats/sinking/tanker_71.jpg  \n","  inflating: Boats/sinking/tanker_72.jpg  \n","  inflating: Boats/sinking/tanker_73.jpg  \n","  inflating: Boats/sinking/tanker_76.jpg  \n","  inflating: Boats/sinking/tanker_77.jpg  \n","  inflating: Boats/sinking/tanker_78.jpg  \n","  inflating: Boats/sinking/tanker_79.jpg  \n","  inflating: Boats/sinking/tanker_8.jpg  \n","  inflating: Boats/sinking/tanker_80.jpg  \n","  inflating: Boats/sinking/tanker_81.jpg  \n","  inflating: Boats/sinking/tanker_82.jpg  \n","  inflating: Boats/sinking/tanker_83.jpg  \n","  inflating: Boats/sinking/tanker_84.jpg  \n","  inflating: Boats/sinking/tanker_85.jpg  \n","  inflating: Boats/sinking/tanker_86.jpg  \n","  inflating: Boats/sinking/tanker_87.jpg  \n","  inflating: Boats/sinking/tanker_88.jpg  \n","  inflating: Boats/sinking/tanker_9.jpg  \n","  inflating: Boats/sinking/tanker_91.jpg  \n","  inflating: Boats/sinking/tanker_92.jpg  \n","  inflating: Boats/sinking/tanker_93.jpg  \n","  inflating: Boats/sinking/tanker_94.jpg  \n","  inflating: Boats/sinking/tanker_95.jpg  \n","  inflating: Boats/sinking/tanker_96.jpg  \n","  inflating: Boats/sinking/tanker_97.jpg  \n","  inflating: Boats/sinking/tanker_98.jpg  \n"]}]},{"cell_type":"code","source":["import tensorflow as tf\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Dense, Conv2D, MaxPooling2D, Flatten, Dropout\n","from tensorflow.keras.preprocessing.image import ImageDataGenerator\n","import os"],"metadata":{"id":"vctDUanzQi4P","executionInfo":{"status":"ok","timestamp":1732875103724,"user_tz":-60,"elapsed":4640,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["import os\n","\n","\n","base_dir = '/content/Boats'\n","labels = os.listdir(base_dir)\n","image_counts = {}\n","for label in labels:\n","    folder_path = os.path.join(base_dir, label)\n","    if os.path.isdir(folder_path):\n","        num_images = len(os.listdir(folder_path))\n","        image_counts[label] = num_images\n","\n","for label, count in image_counts.items():\n","    print(f\"Label '{label}' has {count} images.\")"],"metadata":{"id":"cp5eWU6iSyRR","executionInfo":{"status":"ok","timestamp":1732875110055,"user_tz":-60,"elapsed":7,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"0085d00b-40ad-432f-de60-41ee735d19be","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["Label 'fire' has 431 images.\n","Label 'sinking' has 272 images.\n"]}]},{"cell_type":"code","source":["from tensorflow.keras.preprocessing.image import ImageDataGenerator, img_to_array, load_img\n","import os\n","import numpy as np"],"metadata":{"id":"H3eh27uQTrEt","executionInfo":{"status":"ok","timestamp":1732875117156,"user_tz":-60,"elapsed":185,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["augmenter = ImageDataGenerator(\n","    rotation_range=10,\n","    horizontal_flip=False,\n","    fill_mode='nearest'\n",")"],"metadata":{"id":"UxaVyzacYmp5","executionInfo":{"status":"ok","timestamp":1732875120846,"user_tz":-60,"elapsed":190,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["# Paths\n","sinking_folder = os.path.join('/content/Boats', 'sinking')  # Path to 'sinking' folder\n","output_folder = os.path.join('/content/Boats', 'sinking_augmented')  # New folder for augmented images\n","\n","\n","os.makedirs(output_folder, exist_ok=True)\n","augmentations_per_image = 2\n","\n","# Augment images\n","for img_name in os.listdir(sinking_folder):\n","    img_path = os.path.join(sinking_folder, img_name)\n","\n","    # Load the image\n","    img = load_img(img_path)  # Load image\n","    img_array = img_to_array(img)  # Convert to NumPy array\n","    img_array = np.expand_dims(img_array, axis=0)  # Add batch dimension\n","\n","    # Generate augmented images\n","    i = 0\n","    for batch in augmenter.flow(img_array, batch_size=1, save_to_dir=output_folder,\n","                                save_prefix='sinking_aug', save_format='jpg'):\n","        i += 1\n","        if i >= augmentations_per_image:  # Stop after creating the desired number of augmentations\n","            break"],"metadata":{"id":"oH_9JMcPYyEe","executionInfo":{"status":"ok","timestamp":1732875140441,"user_tz":-60,"elapsed":15031,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["augmented_images = os.listdir(output_folder)\n","print(f\"Augmentation complete. {len(augmented_images)} images created in '{output_folder}'.\")"],"metadata":{"id":"kQPrSFVrY_sW","executionInfo":{"status":"ok","timestamp":1732741963027,"user_tz":-60,"elapsed":222,"user":{"displayName":"","userId":""}},"outputId":"02df759e-648d-41f5-cf3b-941ac1e38a46","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Augmentation complete. 529 images created in '/content/Boats/sinking_augmented'.\n"]}]},{"cell_type":"code","source":["import shutil\n","\n","# Specify the directory to delete\n","folder_path = '/content/Boats/sinking'\n","\n","# Delete the folder and its contents\n","shutil.rmtree(folder_path)\n","\n","print(f\"Folder '{folder_path}' has been deleted.\")"],"metadata":{"id":"fhSXm0DTZMsX","executionInfo":{"status":"ok","timestamp":1732875219786,"user_tz":-60,"elapsed":178,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"11145b7d-dfa2-48f6-efc5-d036bcad998d","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["Folder '/content/Boats/sinking' has been deleted.\n"]}]},{"cell_type":"code","source":["import os\n","from sklearn.model_selection import train_test_split\n","import shutil"],"metadata":{"id":"6VUlHSGybSVj","executionInfo":{"status":"ok","timestamp":1732875246297,"user_tz":-60,"elapsed":2419,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","source":["# Define paths\n","base_dir = '/content/Boats'\n","train_dir = os.path.join(base_dir, 'train')\n","test_dir = os.path.join(base_dir, 'test')\n","\n","# Create train and test directories\n","os.makedirs(train_dir, exist_ok=True)\n","os.makedirs(test_dir, exist_ok=True)\n","\n","# Create class subfolders\n","classes = ['fire', 'sinking']\n","for cls in classes:\n","    os.makedirs(os.path.join(train_dir, cls), exist_ok=True)\n","    os.makedirs(os.path.join(test_dir, cls), exist_ok=True)"],"metadata":{"id":"fH_qQWrKblAZ","executionInfo":{"status":"ok","timestamp":1732875250110,"user_tz":-60,"elapsed":173,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["split_ratio = 0.8  # 80% train, 20% test\n","\n","for cls in classes:\n","    class_folder = os.path.join(base_dir, cls)\n","    images = os.listdir(class_folder)\n","\n","    # Split into train and test\n","    train_images, test_images = train_test_split(images, test_size=0.2, random_state=42)\n","\n","    # Move files to train folder\n","    for img in train_images:\n","        shutil.move(os.path.join(class_folder, img), os.path.join(train_dir, cls, img))\n","\n","    # Move files to test folder\n","    for img in test_images:\n","        shutil.move(os.path.join(class_folder, img), os.path.join(test_dir, cls, img))\n","\n","print(\"Train-test split completed!\")"],"metadata":{"id":"98jYS6zZbrmG","executionInfo":{"status":"ok","timestamp":1732875255280,"user_tz":-60,"elapsed":189,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"66823042-ba09-429d-e726-ec954a39be39","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["Train-test split completed!\n"]}]},{"cell_type":"code","source":["for folder in [train_dir, test_dir]:\n","    print(f\"\\nIn {folder}:\")\n","    for cls in classes:\n","        path = os.path.join(folder, cls)\n","        print(f\"Class '{cls}': {len(os.listdir(path))} images\")"],"metadata":{"id":"tVBMkNxLc8nC","executionInfo":{"status":"ok","timestamp":1732875259776,"user_tz":-60,"elapsed":183,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"138ac5d4-acb6-4aae-d1fe-4681cec8961a","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["\n","In /content/Boats/train:\n","Class 'fire': 344 images\n","Class 'sinking': 428 images\n","\n","In /content/Boats/test:\n","Class 'fire': 87 images\n","Class 'sinking': 107 images\n"]}]},{"cell_type":"code","source":["from tensorflow.keras.preprocessing.image import ImageDataGenerator\n","\n","# Define train and test data generators\n","train_datagen = ImageDataGenerator(rescale=1./255)\n","test_datagen = ImageDataGenerator(rescale=1./255)\n","\n","# Prepare train and test datasets\n","train_generator = train_datagen.flow_from_directory(\n","    train_dir,\n","    target_size=(225, 225),\n","    batch_size=32,\n","    class_mode='categorical'\n",")\n","\n","test_generator = test_datagen.flow_from_directory(\n","    test_dir,\n","    target_size=(225, 225),\n","    batch_size=32,\n","    class_mode='categorical'\n",")"],"metadata":{"id":"qzTMYwKQeh4B","executionInfo":{"status":"ok","timestamp":1732875290312,"user_tz":-60,"elapsed":199,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"6459e87e-778a-4592-e68e-23c4b52ec8ff","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":13,"outputs":[{"output_type":"stream","name":"stdout","text":["Found 772 images belonging to 2 classes.\n","Found 194 images belonging to 2 classes.\n"]}]},{"cell_type":"code","source":["print(\"Class labels:\", train_generator.class_indices)\n","num_classes = len(train_generator.class_indices)\n","print(f\"Number of classes in train_generator: {num_classes}\")"],"metadata":{"id":"BAMBxvJuh-AT","executionInfo":{"status":"ok","timestamp":1732875307422,"user_tz":-60,"elapsed":162,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"c2d4a7d9-2cac-4f58-9b89-cfc4a02d934b","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["Class labels: {'fire': 0, 'sinking': 1}\n","Number of classes in train_generator: 2\n"]}]},{"cell_type":"code","source":["from tensorflow.keras.applications import InceptionV3\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Dense, GlobalAveragePooling2D, Dropout\n","from tensorflow.keras.optimizers import Adam\n","\n","base_model = InceptionV3(weights='imagenet', include_top=False, input_shape=(225, 225, 3))\n","base_model.trainable = False\n","\n","\n","model = Sequential([\n","    base_model,\n","    GlobalAveragePooling2D(),\n","    Dense(1024, activation='relu'),\n","    Dropout(0.5),\n","    Dense(2, activation='softmax')\n","])\n","\n","#fine tuning\n","base_model.trainable = True\n","for layer in base_model.layers[:-20]:\n","    layer.trainable = False\n","\n","\n","model.compile(optimizer=Adam(learning_rate=1e-5), loss='categorical_crossentropy', metrics=['accuracy'])\n","\n","model.summary()"],"metadata":{"id":"zMRwGkHciqAq","colab":{"base_uri":"https://localhost:8080/","height":323},"executionInfo":{"status":"ok","timestamp":1732875402718,"user_tz":-60,"elapsed":2818,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"6967b1e8-1114-4006-8a2c-f1fac35cda8a"},"execution_count":17,"outputs":[{"output_type":"display_data","data":{"text/plain":["\u001b[1mModel: \"sequential_2\"\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"sequential_2\"</span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n","┃\u001b[1m \u001b[0m\u001b[1mLayer (type)                        \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1mOutput Shape               \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1m        Param #\u001b[0m\u001b[1m \u001b[0m┃\n","┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n","│ inception_v3 (\u001b[38;5;33mFunctional\u001b[0m)            │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m5\u001b[0m, \u001b[38;5;34m5\u001b[0m, \u001b[38;5;34m2048\u001b[0m)          │      \u001b[38;5;34m21,802,784\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ global_average_pooling2d_2           │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m2048\u001b[0m)                │               \u001b[38;5;34m0\u001b[0m │\n","│ (\u001b[38;5;33mGlobalAveragePooling2D\u001b[0m)             │                             │                 │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_4 (\u001b[38;5;33mDense\u001b[0m)                      │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1024\u001b[0m)                │       \u001b[38;5;34m2,098,176\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dropout_2 (\u001b[38;5;33mDropout\u001b[0m)                  │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1024\u001b[0m)                │               \u001b[38;5;34m0\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_5 (\u001b[38;5;33mDense\u001b[0m)                      │ (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m2\u001b[0m)                   │           \u001b[38;5;34m2,050\u001b[0m │\n","└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n","┃<span style=\"font-weight: bold\"> Layer (type)                         </span>┃<span style=\"font-weight: bold\"> Output Shape                </span>┃<span style=\"font-weight: bold\">         Param # </span>┃\n","┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n","│ inception_v3 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Functional</span>)            │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">5</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">5</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">2048</span>)          │      <span style=\"color: #00af00; text-decoration-color: #00af00\">21,802,784</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ global_average_pooling2d_2           │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">2048</span>)                │               <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n","│ (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">GlobalAveragePooling2D</span>)             │                             │                 │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_4 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                      │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1024</span>)                │       <span style=\"color: #00af00; text-decoration-color: #00af00\">2,098,176</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dropout_2 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)                  │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1024</span>)                │               <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_5 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                      │ (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">2</span>)                   │           <span style=\"color: #00af00; text-decoration-color: #00af00\">2,050</span> │\n","└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Total params: \u001b[0m\u001b[38;5;34m23,903,010\u001b[0m (91.18 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">23,903,010</span> (91.18 MB)\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Trainable params: \u001b[0m\u001b[38;5;34m4,035,586\u001b[0m (15.39 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">4,035,586</span> (15.39 MB)\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Non-trainable params: \u001b[0m\u001b[38;5;34m19,867,424\u001b[0m (75.79 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">19,867,424</span> (75.79 MB)\n","</pre>\n"]},"metadata":{}}]},{"cell_type":"code","source":["model = tf.keras.models.load_model('/content/drive/MyDrive/Machine Learning with TensorFlow/Ships_Classfication/boat_model.h5')\n","print(\"Model loaded from SavedModel format\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"u_OhnQNaa5q5","executionInfo":{"status":"ok","timestamp":1732875429666,"user_tz":-60,"elapsed":4507,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"152fe7d6-28fc-471b-ed08-2b3994aac14f"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:absl:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.\n"]},{"output_type":"stream","name":"stdout","text":["Model loaded from SavedModel format\n"]}]},{"cell_type":"code","source":["# Training the model\n","history_fine_tune = model.fit(\n","    train_generator,\n","    epochs=10,\n","    validation_data=test_generator,\n","    steps_per_epoch=train_generator.samples // train_generator.batch_size,\n","    validation_steps=test_generator.samples // test_generator.batch_size\n",")"],"metadata":{"id":"W-ylAt70kM4T","executionInfo":{"status":"ok","timestamp":1732746131379,"user_tz":-60,"elapsed":711044,"user":{"displayName":"","userId":""}},"outputId":"572f6f45-c84c-4215-89c7-2cf2f83bf60b","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m148s\u001b[0m 6s/step - accuracy: 0.9335 - loss: 0.2253 - val_accuracy: 0.9375 - val_loss: 0.2182\n","Epoch 2/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 17ms/step - accuracy: 0.9062 - loss: 0.2844 - val_accuracy: 1.0000 - val_loss: 0.0532\n","Epoch 3/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m130s\u001b[0m 6s/step - accuracy: 0.9240 - loss: 0.2027 - val_accuracy: 0.9271 - val_loss: 0.2013\n","Epoch 4/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 9ms/step - accuracy: 0.9688 - loss: 0.1907 - val_accuracy: 1.0000 - val_loss: 0.0402\n","Epoch 5/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m137s\u001b[0m 6s/step - accuracy: 0.9300 - loss: 0.1963 - val_accuracy: 0.9219 - val_loss: 0.1908\n","Epoch 6/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 9ms/step - accuracy: 0.9688 - loss: 0.1852 - val_accuracy: 1.0000 - val_loss: 0.0036\n","Epoch 7/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m132s\u001b[0m 6s/step - accuracy: 0.9520 - loss: 0.1529 - val_accuracy: 0.9323 - val_loss: 0.1787\n","Epoch 8/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m6s\u001b[0m 15ms/step - accuracy: 0.8438 - loss: 0.2246 - val_accuracy: 1.0000 - val_loss: 0.0654\n","Epoch 9/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m129s\u001b[0m 5s/step - accuracy: 0.9481 - loss: 0.1487 - val_accuracy: 0.9427 - val_loss: 0.1688\n","Epoch 10/10\n","\u001b[1m23/23\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m15s\u001b[0m 494ms/step - accuracy: 0.9375 - loss: 0.1316 - val_accuracy: 1.0000 - val_loss: 0.1915\n"]}]},{"cell_type":"code","source":["test_loss, test_acc = model.evaluate(test_generator)\n","print(f\"Test accuracy: {test_acc}\")"],"metadata":{"id":"oVXefP4TpML7","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732875481526,"user_tz":-60,"elapsed":45748,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"ce87e40f-8197-4717-bd4d-f5ad485483bd"},"execution_count":19,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/keras/src/trainers/data_adapters/py_dataset_adapter.py:122: UserWarning: Your `PyDataset` class should call `super().__init__(**kwargs)` in its constructor. `**kwargs` can include `workers`, `use_multiprocessing`, `max_queue_size`. Do not pass these arguments to `fit()`, as they will be ignored.\n","  self._warn_if_super_not_called()\n"]},{"output_type":"stream","name":"stdout","text":["\u001b[1m7/7\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m30s\u001b[0m 4s/step - accuracy: 0.9296 - loss: 0.1933\n","Test accuracy: 0.9329897165298462\n"]}]},{"cell_type":"code","source":["from google.colab import files\n","from tensorflow.keras.preprocessing.image import load_img, img_to_array\n","import numpy as np\n","\n","\n","uploaded = files.upload()\n","image_path = list(uploaded.keys())[0]\n","print(f\"Image uploaded: {image_path}\")\n","\n","\n","img = load_img(image_path, target_size=(225, 225))\n","img_array = img_to_array(img)\n","img_array = np.expand_dims(img_array, axis=0)\n","img_array = img_array / 255.0\n","\n","print(\"Image preprocessed and ready for prediction.\")\n","\n","prediction = model.predict(img_array)\n","print(f\"Prediction: {prediction}\")\n","\n","\n","class_labels = train_generator.class_indices\n","class_labels = {v: k for k, v in class_labels.items()}\n","predicted_class = class_labels[np.argmax(prediction)]\n","print(f\"Predicted Class: {predicted_class}\")"],"metadata":{"id":"0MXSrneysz0-","executionInfo":{"status":"ok","timestamp":1732885162105,"user_tz":-60,"elapsed":6844,"user":{"displayName":"saimohit vanapala","userId":"10035056715768586264"}},"outputId":"e4e53d9d-1902-4814-a0c7-009c83b61797","colab":{"base_uri":"https://localhost:8080/","height":160}},"execution_count":31,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","     <input type=\"file\" id=\"files-8a0e6d93-aa85-4691-b3ab-5800f62928fa\" name=\"files[]\" multiple disabled\n","        style=\"border:none\" />\n","     <output id=\"result-8a0e6d93-aa85-4691-b3ab-5800f62928fa\">\n","      Upload widget is only available when the cell has been executed in the\n","      current browser session. Please rerun this cell to enable.\n","      </output>\n","      <script>// Copyright 2017 Google LLC\n","//\n","// Licensed under the Apache License, Version 2.0 (the \"License\");\n","// you may not use this file except in compliance with the License.\n","// You may obtain a copy of the License at\n","//\n","//      http://www.apache.org/licenses/LICENSE-2.0\n","//\n","// Unless required by applicable law or agreed to in writing, software\n","// distributed under the License is distributed on an \"AS IS\" BASIS,\n","// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n","// See the License for the specific language governing permissions and\n","// limitations under the License.\n","\n","/**\n"," * @fileoverview Helpers for google.colab Python module.\n"," */\n","(function(scope) {\n","function span(text, styleAttributes = {}) {\n","  const element = document.createElement('span');\n","  element.textContent = text;\n","  for (const key of Object.keys(styleAttributes)) {\n","    element.style[key] = styleAttributes[key];\n","  }\n","  return element;\n","}\n","\n","// Max number of bytes which will be uploaded at a time.\n","const MAX_PAYLOAD_SIZE = 100 * 1024;\n","\n","function _uploadFiles(inputId, outputId) {\n","  const steps = uploadFilesStep(inputId, outputId);\n","  const outputElement = document.getElementById(outputId);\n","  // Cache steps on the outputElement to make it available for the next call\n","  // to uploadFilesContinue from Python.\n","  outputElement.steps = steps;\n","\n","  return _uploadFilesContinue(outputId);\n","}\n","\n","// This is roughly an async generator (not supported in the browser yet),\n","// where there are multiple asynchronous steps and the Python side is going\n","// to poll for completion of each step.\n","// This uses a Promise to block the python side on completion of each step,\n","// then passes the result of the previous step as the input to the next step.\n","function _uploadFilesContinue(outputId) {\n","  const outputElement = document.getElementById(outputId);\n","  const steps = outputElement.steps;\n","\n","  const next = steps.next(outputElement.lastPromiseValue);\n","  return Promise.resolve(next.value.promise).then((value) => {\n","    // Cache the last promise value to make it available to the next\n","    // step of the generator.\n","    outputElement.lastPromiseValue = value;\n","    return next.value.response;\n","  });\n","}\n","\n","/**\n"," * Generator function which is called between each async step of the upload\n"," * process.\n"," * @param {string} inputId Element ID of the input file picker element.\n"," * @param {string} outputId Element ID of the output display.\n"," * @return {!Iterable<!Object>} Iterable of next steps.\n"," */\n","function* uploadFilesStep(inputId, outputId) {\n","  const inputElement = document.getElementById(inputId);\n","  inputElement.disabled = false;\n","\n","  const outputElement = document.getElementById(outputId);\n","  outputElement.innerHTML = '';\n","\n","  const pickedPromise = new Promise((resolve) => {\n","    inputElement.addEventListener('change', (e) => {\n","      resolve(e.target.files);\n","    });\n","  });\n","\n","  const cancel = document.createElement('button');\n","  inputElement.parentElement.appendChild(cancel);\n","  cancel.textContent = 'Cancel upload';\n","  const cancelPromise = new Promise((resolve) => {\n","    cancel.onclick = () => {\n","      resolve(null);\n","    };\n","  });\n","\n","  // Wait for the user to pick the files.\n","  const files = yield {\n","    promise: Promise.race([pickedPromise, cancelPromise]),\n","    response: {\n","      action: 'starting',\n","    }\n","  };\n","\n","  cancel.remove();\n","\n","  // Disable the input element since further picks are not allowed.\n","  inputElement.disabled = true;\n","\n","  if (!files) {\n","    return {\n","      response: {\n","        action: 'complete',\n","      }\n","    };\n","  }\n","\n","  for (const file of files) {\n","    const li = document.createElement('li');\n","    li.append(span(file.name, {fontWeight: 'bold'}));\n","    li.append(span(\n","        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +\n","        `last modified: ${\n","            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :\n","                                    'n/a'} - `));\n","    const percent = span('0% done');\n","    li.appendChild(percent);\n","\n","    outputElement.appendChild(li);\n","\n","    const fileDataPromise = new Promise((resolve) => {\n","      const reader = new FileReader();\n","      reader.onload = (e) => {\n","        resolve(e.target.result);\n","      };\n","      reader.readAsArrayBuffer(file);\n","    });\n","    // Wait for the data to be ready.\n","    let fileData = yield {\n","      promise: fileDataPromise,\n","      response: {\n","        action: 'continue',\n","      }\n","    };\n","\n","    // Use a chunked sending to avoid message size limits. See b/62115660.\n","    let position = 0;\n","    do {\n","      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);\n","      const chunk = new Uint8Array(fileData, position, length);\n","      position += length;\n","\n","      const base64 = btoa(String.fromCharCode.apply(null, chunk));\n","      yield {\n","        response: {\n","          action: 'append',\n","          file: file.name,\n","          data: base64,\n","        },\n","      };\n","\n","      let percentDone = fileData.byteLength === 0 ?\n","          100 :\n","          Math.round((position / fileData.byteLength) * 100);\n","      percent.textContent = `${percentDone}% done`;\n","\n","    } while (position < fileData.byteLength);\n","  }\n","\n","  // All done.\n","  yield {\n","    response: {\n","      action: 'complete',\n","    }\n","  };\n","}\n","\n","scope.google = scope.google || {};\n","scope.google.colab = scope.google.colab || {};\n","scope.google.colab._files = {\n","  _uploadFiles,\n","  _uploadFilesContinue,\n","};\n","})(self);\n","</script> "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Saving test.png to test.png\n","Image uploaded: test.png\n","Image preprocessed and ready for prediction.\n","\u001b[1m1/1\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 151ms/step\n","Prediction: [[0.19036615 0.80963385]]\n","Predicted Class: sinking\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"j_zxRemUbbCb"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1732746389197}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}